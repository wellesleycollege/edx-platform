<%! from django.utils.translation import ugettext as _ %>

% if display_name is not UNDEFINED and display_name is not None:
    <h2>${display_name}</h2>
% endif

<div
    id="video_${id}"
    class="video closed"
    data-streams="${youtube_streams}"
      ${'data-sub="{}"'.format(sub) if sub else ''}
      ${'data-autoplay="{}"'.format(autoplay) if autoplay else ''}
    data-sources='${sources}'
    data-save-state-url="${ajax_url}"
    data-caption-data-dir="${data_dir}"
    data-show-captions="${show_captions}"
    data-general-speed="${general_speed}"
    data-speed="${speed}"
    data-saved-video-position="${saved_video_position}"
    data-start="${start}"
    data-end="${end}"
    data-transcript-language="${transcript_language}"
    data-transcript-languages='${transcript_languages}'
    data-autoplay="${autoplay}"
    data-yt-test-timeout="${yt_test_timeout}"
    data-yt-api-url="${yt_api_url}"
    data-yt-test-url="${yt_test_url}"
    data-transcript-translation-url="${transcript_translation_url}"
    data-transcript-available-translations-url="${transcript_available_translations_url}"
    data-autohide-html5="False"
    tabindex="-1"

    ## For now, the option "data-autohide-html5" is hard coded. This option
    ## either enables or disables autohiding of controls and captions on mouse
    ## inactivity. If set to true, controls and captions will autohide for
    ## HTML5 sources (non-YouTube) after a period of mouse inactivity over the
    ## whole video. When the mouse moves (or a key is pressed while any part of
    ## the video player is focused), the captions and controls will be shown
    ## once again.
    ##
    ## There is no option in the "Advanced Editor" to set this option. However,
    ## this option will have an effect if changed to "True". The code on
    ## front-end exists.
>
    <div class="focus_grabber first"></div>

    <div class="tc-wrapper">
      <a href="#before-transcript_${id}" class="nav-skip sr">${_("Skip to a navigable version of this video's transcript.")}</a>

      <article class="video-wrapper" id="video-wrapper">
        <span class="spinner" aria-hidden="false" aria-label="${_('Loading your video')}" tabindex="0"></span>
        <span class="btn-play is-hidden" aria-hidden="true" aria-label="${_('Play video')}" tabindex="-1"></span>
        <div class="video-player-pre"></div>

        <section class="video-player">
          <div id="${id}"></div>
          <div class="video-overlay-captions"></div>
          <h3 class="hidden">${_('No playable video sources were found.')}</h3>
        </section>

        <div class="video-player-post"></div>

        <section class="video-controls is-hidden">
          <div class="wrapper-slider">
            <div class="slider" title="${_('Video position')}"></div>
          </div>
          <div class="controls">
            <button class="play-pause video_control" title="${_('Play')}"><i class="icon fa fa-play" aria-hidden="true"></i> <span class="sr">${_('Play')}</span></button>
            <div class="time vidtime">0:00 / 0:00</div>
            <div class="speeds menu-container">
              <button class="speed speed-button" title="${_('Speed')}"><i class="icon fa fa-caret-right" aria-hidden="true" aria-haspopup="true" aria-controls="speed_menu"></i> ${_('Speed')}: <span class="value">1.0x</span></button>
              <ul id="speed_menu" class="video-speeds menu" role="menu"></ul>
            </div>
            <div class="volume menu-container">
              <button class="volume volume-button" title="${_('Volume')}"><i class="icon fa fa-volume-up" aria-hidden="true" aria-haspopup="true" aria-controls="volume_menu"></i> <span class="sr">${_('Volume')}</span></button>
              <div id="volume_menu" class="volume-slider-container menu" role="presentation">
                <div class="volume-slider"></div>
              </div>
            </div>
            <button class="quality quality-control" title="${_('Toggle quality')}" aria-pressed="false" disabled>HD<span class="sr">${_('Toggle quality')}</span></button>
            <button class="captions show-captions" title="${_('Turn on captions')}" aria-pressed="false"><i class="icon fa fa-cc" aria-hidden="true"></i><span class="sr">${_('Turn on captions')}</span></button>
            <button class="transcript hide-subtitles is-active" title="${_('Turn off the transcript')}" aria-pressed="true"><i class="icon fa fa-align-left" aria-hidden="true"></i><span class="sr">${_('Turn off the transcript')}</span></button>
            <button class="size add-fullscreen" title="${_('Toggle fullscreen')}" aria-pressed="false"><i class="icon fa fa-expand" aria-hidden="true"></i><span class="sr">${_('Toggle fullscreen')}</span></button>
          </div>
        </section>
        <a class="nav-skip sr" id="before-transcript_${id}" href="#after-transcript_${id}">${_('Skip to end of transcript.')}</a>
      </article>

      <ol id="transcript-captions" class="subtitles" tabindex="0" role="group" aria-label="${_('Activating an item in this group will spool the video to the corresponding time point. To skip transcript, go to previous item.')}">
        <li></li>
      </ol>
    </div>

    <a class="nav-skip sr" id="after-transcript_${id}" href="#before-transcript_${id}">${_('Go back to start of transcript.')}</a>

    <div class="focus_grabber last"></div>
  <ul class="wrapper-downloads">
    % if download_video_link:
        <li class="video-sources video-download-button">
            ${('<a href="%s">' + _('Download video') + '</a>') % download_video_link}
        </li>
    % endif
    % if track:
        <li class="video-tracks video-download-button">
          % if transcript_download_format:
            ${('<a href="%s">' + _('Download transcript') + '</a>') % track
            }
            <div class="a11y-menu-container">
                <a class="a11y-menu-button" href="#" title="${'.' + transcript_download_format}">${'.' + transcript_download_format}</a>
                <ol class="a11y-menu-list">
                % for item in transcript_download_formats_list:
                  % if item['value'] == transcript_download_format:
                  <li class="a11y-menu-item active">
                  % else:
                  <li class="a11y-menu-item">
                  % endif
                  ## This is necessary so we don't scrape 'display_name' as a string.
                  <% dname = item['display_name'] %>
                      <a class="a11y-menu-item-link" href="#${item['value']}" title="${_(dname)}" data-value="${item['value']}">
                        ${_(dname)}
                      </a>
                  </li>
                % endfor
                </ol>
            </div>
          % else:
            ${('<a href="%s" class="external-track">' + _('Download transcript') + '</a>') % track
            }
          % endif
        </li>
    % endif
    % if handout:
        <li class="video-handout video-download-button">
            ${('<a href="%s" target="_blank">' + _('Download Handout') + '</a>') % handout}
        </li>
    % endif

    % if branding_info:
      <li id="branding" class="branding">
        <span class="host-tag">${branding_info['logo_tag']}</span>
        <a href="${branding_info['url']}" target="_blank" title="${branding_info['logo_tag']}"><img class="brand-logo" src="${branding_info['logo_src']}" alt="${branding_info['logo_tag']}" /></a>
      </li>
    % endif
  </ul>
</div>
